From a4951b6f017ecb4e9e342be51efe5fc6f7bbfd2f Mon Sep 17 00:00:00 2001
From: Adrien Plazas <kekun.plazas@laposte.net>
Date: Tue, 3 Sep 2019 13:27:22 +0200
Subject: [PATCH 01/27] meson: Add dependency on libhandy 0.0.10

---
 meson.build     | 1 +
 src/gs-main.c   | 4 ++++
 src/meson.build | 1 +
 3 files changed, 6 insertions(+)

diff --git a/meson.build b/meson.build
index b21dbba1..a8f85c76 100644
--- a/meson.build
+++ b/meson.build
@@ -103,6 +103,7 @@ gio_unix = dependency('gio-unix-2.0', version : '>= 2.56.0')
 goa = dependency('goa-1.0')
 gtk = dependency('gtk+-3.0', version : '>= 3.22.4')
 glib = dependency('glib-2.0', version : '>= 2.55.0')
+libhandy = dependency('libhandy-0.0', version: '>= 0.0.10')
 json_glib = dependency('json-glib-1.0', version : '>= 1.2.0')
 libm = cc.find_library('m', required: false)
 libsoup = dependency('libsoup-2.4', version : '>= 2.52.0')
diff --git a/src/gs-main.c b/src/gs-main.c
index ec9c0a63..573e5280 100644
--- a/src/gs-main.c
+++ b/src/gs-main.c
@@ -13,6 +13,8 @@
 #include <gio/gio.h>
 #include <gio/gdesktopappinfo.h>
 #include <gtk/gtk.h>
+#define HANDY_USE_UNSTABLE_API
+#include <handy.h>
 #include <locale.h>
 #include <sys/stat.h>
 
@@ -40,6 +42,8 @@ main (int argc, char **argv)
 	 */
 	umask (022);
 
+	hdy_init (&argc, &argv);
+
 	/* redirect logs */
 	application = gs_application_new ();
 	appinfo = g_desktop_app_info_new ("org.gnome.Software.desktop");
diff --git a/src/meson.build b/src/meson.build
index ea8900ba..797b485a 100644
--- a/src/meson.build
+++ b/src/meson.build
@@ -75,6 +75,7 @@ gnome_software_dependencies = [
   gmodule,
   goa,
   gtk,
+  libhandy,
   json_glib,
   libm,
   libsoup,
-- 
2.26.2
